// bibliotecas basicas do c++
#include <iostream> // entrada e saída de dados (cout, cin)
#include <vector>   // lista dinâmica (vetores que crescem automaticamente)
#include <string>   // pra usar strings (textos)
#include <cstdio>   // funções antigas de arquivo: FILE*, fopen, fprintf, fscanf

using namespace std; // pra não precisar escrever std:: o tempo todo

// estrutura de dados que guarda informações de um usuário
struct Usuario {
    int id;
    string nome;
    string senha;
    string tipo; // "admin" ou "user"
};

// estrutura pra guardar informações das cartas (tipo Pokémon, nome e preço)
struct Carta {
    int id;
    string nome;
    string tipo;
    double preco;
};

// estrutura pra guardar dados de um torneio
struct Torneio {
    string nome;
    vector<string> jogadores; // lista com os nomes dos jogadores
    bool aberto = false;      // se o torneio está aberto ou não
};

// vetores (listas) principais
vector<Usuario> usuarios; // lista de todos os usuários cadastrados
vector<Carta> cartas;     // lista de todas as cartas cadastradas
Torneio torneio;          // o torneio atual

// função pra salvar um usuário novo no arquivo usuarios.txt
void salvarUsuario(Usuario u) {
    FILE* arquivo = fopen("usuarios.txt", "a"); // abre o arquivo em modo "adicionar"
    if (!arquivo) {
        cout << "erro ao abrir arquivo\n";
        return;
    }
    // grava os dados separados por ponto e vírgula
    fprintf(arquivo, "%d;%s;%s;%s\n", u.id, u.nome.c_str(), u.senha.c_str(), u.tipo.c_str());
    fclose(arquivo); // fecha o arquivo
}

// função pra carregar todos os usuários salvos do arquivo
void carregarUsuarios() {
    FILE* arquivo = fopen("usuarios.txt", "r"); // abre pra leitura
    if (!arquivo) return; // se não existir, só sai
    Usuario u;
    char nome[50], senha[50], tipo[10];
    // lê linha por linha no formato id;nome;senha;tipo
    while (fscanf(arquivo, "%d;%49[^;];%49[^;];%9[^\n]\n", &u.id, nome, senha, tipo) == 4) {
        u.nome = nome;
        u.senha = senha;
        u.tipo = tipo;
        usuarios.push_back(u); // adiciona à lista
    }
    fclose(arquivo);
}

// limpa a tela (funciona tanto no windows quanto no linux)
void limparTela() {
#ifdef _WIN32
    system("cls");
#else
    system("clear");
#endif
}

int main() {
    carregarUsuarios(); // carrega os usuários existentes logo no início

    // se o arquivo estava vazio, cria um admin padrão
    if (usuarios.empty()) {
        Usuario admin;
        admin.id = 1;
        admin.nome = "admin";
        admin.senha = "123";
        admin.tipo = "admin";
        usuarios.push_back(admin);
        salvarUsuario(admin);
    }

    int op;
    string nome, senha, tipo;
    bool logad
